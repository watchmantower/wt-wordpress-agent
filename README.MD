# Watchman Tower WordPress Agent

Lightweight WordPress agent plugin for **Watchman Tower**.  
Sends periodic **heartbeat** and **site health** data (WP/PHP versions, theme, plugins, DB/REST/cron checks, security bits) to your Watchman Tower project.

> Repo: `wt-wordpress-agent` Â· License: MIT

---

## âœ¨ Features
- Heartbeat with site health summary (DB, WP-REST, cron overdue, updates count)
- Theme & limited active plugins inventory (sample)
- XML-RPC / registration flags
- Configurable interval (+ server-side override)
- Pause / Send now
- Works without front-end visitors (scheduler, no admin-page trigger)

---

## ğŸš€ Install
1. **Download** the ZIP from GitHub Releases (or your manifest link).
2. WordPress admin â†’ **Plugins â†’ Add New â†’ Upload Plugin** â†’ upload the ZIP and **Activate**.
3. Go to **Settings â†’ Watchman Tower**.
4. Paste the **Integration Token (JWT)** you got from Watchman Tower **Install** flow.
5. Click **Save** then **Send now** to test.

> Tip: The token is one-time/short-lived for setup. You can generate a fresh one anytime from WT UI.

---

## âš™ï¸ Settings
- **Integration Token (JWT)** â€“ required
- **Interval** â€“ default 10 min (server can suggest a different interval)
- **Pause** â€“ stops sending while on

Advanced:
- **Instance ID** â€“ auto-generated UUID (used to identify this WP instance)
- **Last success / Last error** â€“ quick diagnostics

---

## ğŸ“¡ What is sent (payload)
- **identity**: `instanceId`, `pluginVersion`, `sentAt`
- **site**: `homeUrl`, `siteUrl`, `multisite`
- **wordpress**: `wpVersion`, `phpVersion`, `theme{name,version}`, `comments{enabled}`
- **health**: `db{ok}`, `rest{ok}`, `cron{overdue,nextDueInSec}`, `updates{core,plugins,themes}`
- **security**: `xmlrpc{enabled}`, `registration{enabled}`
- **inventory**: `activePlugins{count,sample[]}`

---

## ğŸ§ª Troubleshooting
- **No heartbeat / â€œWaitingâ€¦â€**  
  - Check token and endpoint; try **Send now**.
- **REST check fails**  
  - Some security plugins block `/wp-json/`. Itâ€™s fine; youâ€™ll just see `rest.ok=false`.
- **Cron overdue**  
  - If host blocks WP-Cron, set a real cron:  
    `*/10 * * * * php /path/to/wp/wp-cron.php > /dev/null 2>&1`
- **XML-RPC disabled**  
  - Many hosts/plugins disable it intentionally (expected).

---

## ğŸ”— Links
- ğŸŒ [Watchman Tower Website](https://www.watchmantower.com)
- ğŸ§© [Dashboard / App](https://app.watchmantower.com)
- ğŸ“¨ [Support](mailto:support@watchmantower.com)
- ğŸ§  [GitHub Repository](https://github.com/watchmantower/wt-wordpress-agent)